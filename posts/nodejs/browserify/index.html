<!doctype html><html lang=en><head><title>browserify.md :: Vim Emacser Personal Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="browserify require('modules') in the browser
Use a node-style require() to organize your browser code and load modules installed by npm.
browserify will recursively analyze all the require() calls in your app in order to build a bundle you can serve up to the browser in a single &amp;lt;script&amp;gt; tag.
getting started If you&amp;rsquo;re new to browserify, check out the browserify handbook and the resources on browserify.org.
Check out browserify search to find browserify-compatible packages on npm."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/nodejs/browserify/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content="https://twitter.com/linuxing3"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="browserify.md"><meta property="og:description" content="browserify require('modules') in the browser
Use a node-style require() to organize your browser code and load modules installed by npm.
browserify will recursively analyze all the require() calls in your app in order to build a bundle you can serve up to the browser in a single &amp;lt;script&amp;gt; tag.
getting started If you&amp;rsquo;re new to browserify, check out the browserify handbook and the resources on browserify.org.
Check out browserify search to find browserify-compatible packages on npm."><meta property="og:url" content="/posts/nodejs/browserify/"><meta property="og:site_name" content="Vim Emacser Personal Blog"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2018-02-16 14:05:34 -0400 -0400"></head><body class=green><div class="container full"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Terminal</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/journal>Journal</a></li><li><a href=/showcase>Showcase</a></li><div class=spacer></div><ul class=language-selector><ul class=language-selector-current><li>English ▾</li></ul><ul class="language-selector__more hidden"><li><a href=/>English</a></li><li><a href=/zh/>中文</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/journal>Journal</a></li><li><a href=/showcase>Showcase</a></li><hr><li><a href=/>English</a></li><li><a href=/zh/>中文</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/nodejs/browserify/>browserify.md</a></h1><div class=post-meta><span class=post-date>2018-02-16</span></div><div class=post-content><div><h1 id=browserify>browserify<a href=#browserify class=hanchor arialabel=Anchor>&#8983;</a></h1><p><code>require('modules')</code> in the browser</p><p>Use a <a href=http://nodejs.org>node</a>-style <code>require()</code> to organize your browser code
and load modules installed by <a href=https://www.npmjs.com>npm</a>.</p><p>browserify will recursively analyze all the <code>require()</code> calls in your app in
order to build a bundle you can serve up to the browser in a single <code>&lt;script></code>
tag.</p><p><a href=https://travis-ci.org/substack/node-browserify><img src=https://secure.travis-ci.org/substack/node-browserify.png alt="build status"></a></p><p><img src=http://substack.net/images/browserify_logo.png alt=browserify!></p><h1 id=getting-started>getting started<a href=#getting-started class=hanchor arialabel=Anchor>&#8983;</a></h1><p>If you&rsquo;re new to browserify, check out the
<a href=https://github.com/substack/browserify-handbook>browserify handbook</a>
and the resources on <a href=http://browserify.org/>browserify.org</a>.</p><p>Check out <a href=http://browserifysearch.org/>browserify search</a> to find
browserify-compatible packages on npm.</p><h1 id=example>example<a href=#example class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Whip up a file, <code>main.js</code> with some <code>require()</code>s in it. You can use relative
paths like <code>'./foo.js'</code> and <code>'../lib/bar.js'</code> or module paths like <code>'gamma'</code>
that will search <code>node_modules/</code> using
<a href=https://github.com/substack/node-resolve>node&rsquo;s module lookup algorithm</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>foo</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./foo.js&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>bar</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;../lib/bar.js&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>gamma</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;gamma&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>elem</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;result&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>foo</span>(<span style=color:#ae81ff>100</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>bar</span>(<span style=color:#e6db74>&#39;baz&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>elem</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>gamma</span>(<span style=color:#a6e22e>x</span>);
</span></span></code></pre></div><p>Export functionality by assigning onto <code>module.exports</code> or <code>exports</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>n</span>) { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>n</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>111</span> }
</span></span></code></pre></div><p>Now just use the <code>browserify</code> command to build a bundle starting at <code>main.js</code>:</p><pre tabindex=0><code>$ browserify main.js &gt; bundle.js
</code></pre><p>All of the modules that <code>main.js</code> needs are included in the <code>bundle.js</code> from a
recursive walk of the <code>require()</code> graph using
<a href=https://github.com/defunctzombie/node-required>required</a>.</p><p>To use this bundle, just toss a <code>&lt;script src="bundle.js">&lt;/script></code> into your
html!</p><h1 id=install>install<a href=#install class=hanchor arialabel=Anchor>&#8983;</a></h1><p>With <a href=https://www.npmjs.com/>npm</a> do:</p><pre tabindex=0><code>npm install -g browserify
</code></pre><h1 id=usage>usage<a href=#usage class=hanchor arialabel=Anchor>&#8983;</a></h1><pre tabindex=0><code>Usage: browserify [entry files] {OPTIONS}

Standard Options:

    --outfile, -o  Write the browserify bundle to this file.
                   If unspecified, browserify prints to stdout.

    --require, -r  A module name or file to bundle.require()
                   Optionally use a colon separator to set the target.

      --entry, -e  An entry point of your app

     --ignore, -i  Replace a file with an empty stub. Files can be globs.

    --exclude, -u  Omit a file from the output bundle. Files can be globs.

   --external, -x  Reference a file from another bundle. Files can be globs.

  --transform, -t  Use a transform module on top-level files.

    --command, -c  Use a transform command on top-level files.

  --standalone -s  Generate a UMD bundle for the supplied export name.
                   This bundle works with other module systems and sets the name
                   given as a window global if no module system is found.

       --debug -d  Enable source maps that allow you to debug your files
                   separately.

       --help, -h  Show this message

For advanced options, type `browserify --help advanced`.

Specify a parameter.
</code></pre><pre tabindex=0><code>Advanced Options:

  --insert-globals, --ig, --fast    [default: false]

    Skip detection and always insert definitions for process, global,
    __filename, and __dirname.

    benefit: faster builds
    cost: extra bytes

  --insert-global-vars, --igv

    Comma-separated list of global variables to detect and define.
    Default: __filename,__dirname,process,Buffer,global

  --detect-globals, --dg            [default: true]

    Detect the presence of process, global, __filename, and __dirname and define
    these values when present.

    benefit: npm modules more likely to work
    cost: slower builds

  --ignore-missing, --im            [default: false]

    Ignore `require()` statements that don&#39;t resolve to anything.

  --noparse=FILE

    Don&#39;t parse FILE at all. This will make bundling much, much faster for giant
    libs like jquery or threejs.

  --no-builtins

    Turn off builtins. This is handy when you want to run a bundle in node which
    provides the core builtins.

  --no-commondir

    Turn off setting a commondir. This is useful if you want to preserve the
    original paths that a bundle was generated with.

  --no-bundle-external

    Turn off bundling of all external modules. This is useful if you only want
    to bundle your local files.

  --bare

    Alias for both --no-builtins, --no-commondir, and sets --insert-global-vars
    to just &#34;__filename,__dirname&#34;. This is handy if you want to run bundles in
    node.

  --no-browser-field, --no-bf

    Turn off package.json browser field resolution. This is also handy if you
    need to run a bundle in node.

  --node

    Alias for --bare and --no-browser-field.

  --full-paths

    Turn off converting module ids into numerical indexes. This is useful for
    preserving the original paths that a bundle was generated with.

  --deps

    Instead of standard bundle output, print the dependency array generated by
    module-deps.

  --list

    Print each file in the dependency graph. Useful for makefiles.

  --extension=EXTENSION

    Consider files with specified EXTENSION as modules, this option can used
    multiple times.

  --global-transform=MODULE, -g MODULE

    Use a transform module on all files after any ordinary transforms have run.

  --plugin=MODULE, -p MODULE

    Register MODULE as a plugin.

Passing arguments to transforms and plugins:

  For -t, -g, and -p, you may use subarg syntax to pass options to the
  transforms or plugin function as the second parameter. For example:

    -t [ foo -x 3 --beep ]

  will call the `foo` transform for each applicable file by calling:

    foo(file, { x: 3, beep: true })
</code></pre><h1 id=compatibility>compatibility<a href=#compatibility class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Many <a href=https://www.npmjs.com/>npm</a> modules that don&rsquo;t do IO will just work after being
browserified. Others take more work.</p><p>Many node built-in modules have been wrapped to work in the browser, but only
when you explicitly <code>require()</code> or use their functionality.</p><p>When you <code>require()</code> any of these modules, you will get a browser-specific shim:</p><ul><li><a href=https://www.npmjs.com/package/assert>assert</a></li><li><a href=https://www.npmjs.com/package/buffer>buffer</a></li><li><a href=https://www.npmjs.com/package/console-browserify>console</a></li><li><a href=https://www.npmjs.com/package/constants-browserify>constants</a></li><li><a href=https://www.npmjs.com/package/crypto-browserify>crypto</a></li><li><a href=https://www.npmjs.com/package/domain-browser>domain</a></li><li><a href=https://www.npmjs.com/package/events>events</a></li><li><a href=https://www.npmjs.com/package/stream-http>http</a></li><li><a href=https://www.npmjs.com/package/https-browserify>https</a></li><li><a href=https://www.npmjs.com/package/os-browserify>os</a></li><li><a href=https://www.npmjs.com/package/path-browserify>path</a></li><li><a href=https://www.npmjs.com/package/punycode>punycode</a></li><li><a href=https://www.npmjs.com/package/querystring-es3>querystring</a></li><li><a href=https://www.npmjs.com/package/stream-browserify>stream</a></li><li><a href=https://www.npmjs.com/package/string_decoder>string_decoder</a></li><li><a href=https://www.npmjs.com/package/timers-browserify>timers</a></li><li><a href=https://www.npmjs.com/package/tty-browserify>tty</a></li><li><a href=https://www.npmjs.com/package/url>url</a></li><li><a href=https://www.npmjs.com/package/util>util</a></li><li><a href=https://www.npmjs.com/package/vm-browserify>vm</a></li><li><a href=https://www.npmjs.com/package/browserify-zlib>zlib</a></li></ul><p>Additionally, if you use any of these variables, they
<a href=https://github.com/substack/insert-module-globals>will be defined</a>
in the bundled output in a browser-appropriate way:</p><ul><li><a href=https://www.npmjs.com/package/process>process</a></li><li><a href=https://www.npmjs.com/package/buffer>Buffer</a></li><li>global - top-level scope object (window)</li><li>__filename - file path of the currently executing file</li><li>__dirname - directory path of the currently executing file</li></ul><h1 id=more-examples>more examples<a href=#more-examples class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=external-requires>external requires<a href=#external-requires class=hanchor arialabel=Anchor>&#8983;</a></h2><p>You can just as easily create a bundle that will export a <code>require()</code> function so
you can <code>require()</code> modules from another script tag. Here we&rsquo;ll create a
<code>bundle.js</code> with the <a href=https://www.npmjs.com/package/through>through</a>
and <a href=https://www.npmjs.com/package/duplexer>duplexer</a> modules.</p><pre tabindex=0><code>$ browserify -r through -r duplexer -r ./my-file.js:my-module &gt; bundle.js
</code></pre><p>Then in your page you can do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bundle.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>through</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;through&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>duplexer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;duplexer&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>myModule</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;my-module&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* ... */</span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><h2 id=external-source-maps>external source maps<a href=#external-source-maps class=hanchor arialabel=Anchor>&#8983;</a></h2><p>If you prefer the source maps be saved to a separate <code>.js.map</code> source map file, you may use
<a href=https://github.com/thlorenz/exorcist>exorcist</a> in order to achieve that. It&rsquo;s as simple as:</p><pre tabindex=0><code>$ browserify main.js --debug | exorcist bundle.js.map &gt; bundle.js
</code></pre><p>Learn about additional options <a href=https://github.com/thlorenz/exorcist#usage>here</a>.</p><h2 id=multiple-bundles>multiple bundles<a href=#multiple-bundles class=hanchor arialabel=Anchor>&#8983;</a></h2><p>If browserify finds a <code>require</code>d function already defined in the page scope, it
will fall back to that function if it didn&rsquo;t find any matches in its own set of
bundled modules.</p><p>In this way, you can use browserify to split up bundles among multiple pages to
get the benefit of caching for shared, infrequently-changing modules, while
still being able to use <code>require()</code>. Just use a combination of <code>--external</code> and
<code>--require</code> to factor out common dependencies.</p><p>For example, if a website with 2 pages, <code>beep.js</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>robot</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./robot.js&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>robot</span>(<span style=color:#e6db74>&#39;beep&#39;</span>));
</span></span></code></pre></div><p>and <code>boop.js</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>robot</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./robot.js&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>robot</span>(<span style=color:#e6db74>&#39;boop&#39;</span>));
</span></span></code></pre></div><p>both depend on <code>robot.js</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>s</span>) { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>toUpperCase</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;!&#39;</span> };
</span></span></code></pre></div><pre tabindex=0><code>$ browserify -r ./robot.js &gt; static/common.js
$ browserify -x ./robot.js beep.js &gt; static/beep.js
$ browserify -x ./robot.js boop.js &gt; static/boop.js
</code></pre><p>Then on the beep page you can have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;common.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;beep.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>while the boop page can have:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;common.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;boop.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>This approach using <code>-r</code> and <code>-x</code> works fine for a small number of split assets,
but there are plugins for automatically factoring out components which are
described in the
<a href=https://github.com/substack/browserify-handbook#partitioning>partitioning section of the browserify handbook</a>.</p><h2 id=api-example>api example<a href=#api-example class=hanchor arialabel=Anchor>&#8983;</a></h2><p>You can use the API directly too:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>browserify</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;browserify&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>browserify</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>add</span>(<span style=color:#e6db74>&#39;./browser/main.js&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>bundle</span>().<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>stdout</span>);
</span></span></code></pre></div><h1 id=methods>methods<a href=#methods class=hanchor arialabel=Anchor>&#8983;</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>browserify</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;browserify&#39;</span>)
</span></span></code></pre></div><h2 id=browserifyfiles--opts><code>browserify([files] [, opts])</code><a href=#browserifyfiles--opts class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Returns a new browserify instance.</p><p><code>files</code> and <code>opts</code> are both optional, but must be in the order shown if both are
passed.</p><p>Entry files may be passed in <code>files</code> and / or <code>opts.entries</code>.</p><p>If an entry file is a stream, its contents will be used. You should pass
<code>opts.basedir</code> when using streaming files so that relative requires can be
resolved.</p><p><code>opts.entries</code> has the same definition as <code>files</code>.</p><p><code>opts.noParse</code> is an array which will skip all require() and global parsing for
each file in the array. Use this for giant libs like jquery or threejs that
don&rsquo;t have any requires or node-style globals but take forever to parse.</p><p><code>opts.transform</code> is an array of transform functions or modules names which will
transform the source code before the parsing.</p><p><code>opts.extensions</code> is an array of optional extra extensions for the module lookup
machinery to use when the extension has not been specified.
By default browserify considers only <code>.js</code> and <code>.json</code> files in such cases.</p><p><code>opts.basedir</code> is the directory that browserify starts bundling from for
filenames that start with <code>.</code>.</p><p><code>opts.paths</code> is an array of directories that browserify searches when looking
for modules which are not referenced using relative path. Can be absolute or
relative to <code>basedir</code>. Equivalent of setting <code>NODE_PATH</code> environmental variable
when calling <code>browserify</code> command.</p><p><code>opts.commondir</code> sets the algorithm used to parse out the common paths. Use
<code>false</code> to turn this off, otherwise it uses the
<a href=https://www.npmjs.com/package/commondir>commondir</a> module.</p><p><code>opts.fullPaths</code> disables converting module ids into numerical indexes. This is
useful for preserving the original paths that a bundle was generated with.</p><p><code>opts.builtins</code> sets the list of built-ins to use, which by default is set in
<code>lib/builtins.js</code> in this distribution.</p><p><code>opts.bundleExternal</code> boolean option to set if external modules should be
bundled. Defaults to true.</p><p>When <code>opts.insertGlobals</code> is true, always insert <code>process</code>, <code>global</code>,
<code>__filename</code>, and <code>__dirname</code> without analyzing the AST for faster builds but
larger output bundles. Default false.</p><p>When <code>opts.detectGlobals</code> is true, scan all files for <code>process</code>, <code>global</code>,
<code>__filename</code>, and <code>__dirname</code>, defining as necessary. With this option npm
modules are more likely to work but bundling takes longer. Default true.</p><p>When <code>opts.debug</code> is true, add a source map inline to the end of the bundle.
This makes debugging easier because you can see all the original files if
you are in a modern enough browser.</p><p>When <code>opts.standalone</code> is a non-empty string, a standalone module is created
with that name and a <a href=https://github.com/forbeslindesay/umd>umd</a> wrapper.
You can use namespaces in the standalone global export using a <code>.</code> in the string
name as a separator, for example <code>'A.B.C'</code>. The global export will be <a href=https://github.com/ForbesLindesay/umd#name-casing-and-characters>sanitized
and camel cased</a>.</p><p>Note that in standalone mode the <code>require()</code> calls from the original source will
still be around, which may trip up AMD loaders scanning for <code>require()</code> calls.
You can remove these calls with
<a href=https://www.npmjs.com/package/derequire>derequire</a>:</p><pre tabindex=0><code>$ npm install -g derequire
$ browserify main.js --standalone Foo | derequire &gt; bundle.js
</code></pre><p><code>opts.insertGlobalVars</code> will be passed to
<a href=https://www.npmjs.com/package/insert-module-globals>insert-module-globals</a>
as the <code>opts.vars</code> parameter.</p><p><code>opts.externalRequireName</code> defaults to <code>'require'</code> in <code>expose</code> mode but you can
use another name.</p><p>Note that if files do not contain javascript source code then you also need to
specify a corresponding transform for them.</p><p>All other options are forwarded along to
<a href=https://www.npmjs.com/package/module-deps>module-deps</a>
and <a href=https://www.npmjs.com/package/browser-pack>browser-pack</a> directly.</p><h2 id=baddfile-opts>b.add(file, opts)<a href=#baddfile-opts class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Add an entry file from <code>file</code> that will be executed when the bundle loads.</p><p>If <code>file</code> is an array, each item in <code>file</code> will be added as an entry file.</p><h2 id=brequirefile-opts>b.require(file, opts)<a href=#brequirefile-opts class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Make <code>file</code> available from outside the bundle with <code>require(file)</code>.</p><p>The <code>file</code> param is anything that can be resolved by <code>require.resolve()</code>.</p><p><code>file</code> can also be a stream, but you should also use <code>opts.basedir</code> so that
relative requires will be resolvable.</p><p>If <code>file</code> is an array, each item in <code>file</code> will be required.
In <code>file</code> array form, you can use a string or object for each item. Object items
should have a <code>file</code> property and the rest of the parameters will be used for
the <code>opts</code>.</p><p>Use the <code>expose</code> property of opts to specify a custom dependency name.
<code>require('./vendor/angular/angular.js', {expose: 'angular'})</code> enables <code>require('angular')</code></p><h2 id=bbundlecb>b.bundle(cb)<a href=#bbundlecb class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Bundle the files and their dependencies into a single javascript file.</p><p>Return a readable stream with the javascript file contents or
optionally specify a <code>cb(err, buf)</code> to get the buffered results.</p><h2 id=bexternalfile>b.external(file)<a href=#bexternalfile class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Prevent <code>file</code> from being loaded into the current bundle, instead referencing
from another bundle.</p><p>If <code>file</code> is an array, each item in <code>file</code> will be externalized.</p><p>If <code>file</code> is another bundle, that bundle&rsquo;s contents will be read and excluded
from the current bundle as the bundle in <code>file</code> gets bundled.</p><h2 id=bignorefile>b.ignore(file)<a href=#bignorefile class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Prevent the module name or file at <code>file</code> from showing up in the output bundle.</p><p>Instead you will get a file with <code>module.exports = {}</code>.</p><h2 id=bexcludefile>b.exclude(file)<a href=#bexcludefile class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Prevent the module name or file at <code>file</code> from showing up in the output bundle.</p><p>If your code tries to <code>require()</code> that file it will throw unless you&rsquo;ve provided
another mechanism for loading it.</p><h2 id=btransformtr-opts>b.transform(tr, opts={})<a href=#btransformtr-opts class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Transform source code before parsing it for <code>require()</code> calls with the transform
function or module name <code>tr</code>.</p><p>If <code>tr</code> is a function, it will be called with <code>tr(file)</code> and it should return a
<a href=https://github.com/substack/stream-handbook#through>through-stream</a>
that takes the raw file contents and produces the transformed source.</p><p>If <code>tr</code> is a string, it should be a module name or file path of a
<a href=https://github.com/substack/module-deps#transforms>transform module</a>
with a signature of:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>through</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;through&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>file</span>) { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>through</span>() };
</span></span></code></pre></div><p>You don&rsquo;t need to necessarily use the
<a href=https://www.npmjs.com/package/through>through</a> module. Browserify is compatible with the newer, more verbose <a href=http://nodejs.org/api/stream.html#stream_class_stream_transform_1>Transform streams</a> built into Node v0.10.</p><p>Here&rsquo;s how you might compile coffee script on the fly using <code>.transform()</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>coffee</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;coffee-script&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>through</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;through&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>transform</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>file</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>through</span>(<span style=color:#a6e22e>write</span>, <span style=color:#a6e22e>end</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>write</span> (<span style=color:#a6e22e>buf</span>) { <span style=color:#a6e22e>data</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>buf</span> }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>end</span> () {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>queue</span>(<span style=color:#a6e22e>coffee</span>.<span style=color:#a6e22e>compile</span>(<span style=color:#a6e22e>data</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>queue</span>(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>Note that on the command-line with the <code>-c</code> flag you can just do:</p><pre tabindex=0><code>$ browserify -c &#39;coffee -sc&#39; main.coffee &gt; bundle.js
</code></pre><p>Or better still, use the <a href=https://github.com/jnordberg/coffeeify>coffeeify</a>
module:</p><pre tabindex=0><code>$ npm install coffeeify
$ browserify -t coffeeify main.coffee &gt; bundle.js
</code></pre><p>If <code>opts.global</code> is <code>true</code>, the transform will operate on ALL files, despite
whether they exist up a level in a <code>node_modules/</code> directory. Use global
transforms cautiously and sparingly, since most of the time an ordinary
transform will suffice. You can also not configure global transforms in a
<code>package.json</code> like you can with ordinary transforms.</p><p>Global transforms always run after any ordinary transforms have run.</p><p>Transforms may obtain options from the command-line with
<a href=https://www.npmjs.com/package/subarg>subarg</a> syntax:</p><pre tabindex=0><code>$ browserify -t [ foo --bar=555 ] main.js
</code></pre><p>or from the api:</p><pre tabindex=0><code>b.transform(&#39;foo&#39;, { bar: 555 })
</code></pre><p>In both cases, these options are provided as the second argument to the
transform function:</p><pre tabindex=0><code>module.exports = function (file, opts) { /* opts.bar === 555 */ }
</code></pre><p>Options sent to the browserify constructor are also provided under
<code>opts._flags</code>. These browserify options are sometimes required if your transform
needs to do something different when browserify is run in debug mode, for
example.</p><h2 id=bpluginplugin-opts>b.plugin(plugin, opts)<a href=#bpluginplugin-opts class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Register a <code>plugin</code> with <code>opts</code>. Plugins can be a string module name or a
function the same as transforms.</p><p><code>plugin(b, opts)</code> is called with the browserify instance <code>b</code>.</p><p>For more information, consult the plugins section below.</p><h2 id=bpipeline>b.pipeline<a href=#bpipeline class=hanchor arialabel=Anchor>&#8983;</a></h2><p>There is an internal
<a href=https://www.npmjs.com/package/labeled-stream-splicer>labeled-stream-splicer</a>
pipeline with these labels:</p><ul><li><code>'record'</code> - save inputs to play back later on subsequent <code>bundle()</code> calls</li><li><code>'deps'</code> - <a href=https://www.npmjs.com/package/module-deps>module-deps</a></li><li><code>'json'</code> - adds <code>module.exports=</code> to the beginning of json files</li><li><code>'unbom'</code> - remove byte-order markers</li><li><code>'unshebang'</code> - remove #! labels on the first line</li><li><code>'syntax'</code> - check for syntax errors</li><li><code>'sort'</code> - sort the dependencies for deterministic bundles</li><li><code>'dedupe'</code> - remove duplicate source contents</li><li><code>'label'</code> - apply integer labels to files</li><li><code>'emit-deps'</code> - emit <code>'dep'</code> event</li><li><code>'debug'</code> - apply source maps</li><li><code>'pack'</code> - <a href=https://www.npmjs.com/package/browser-pack>browser-pack</a></li><li><code>'wrap'</code> - apply final wrapping, <code>require=</code> and a newline and semicolon</li></ul><p>You can call <code>b.pipeline.get()</code> with a label name to get a handle on a stream pipeline
that you can <code>push()</code>, <code>unshift()</code>, or <code>splice()</code> to insert your own transform
streams.</p><h1 id=bresetopts>b.reset(opts)<a href=#bresetopts class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Reset the pipeline back to a normal state. This function is called automatically
when <code>bundle()</code> is called multiple times.</p><p>This function triggers a &lsquo;reset&rsquo; event.</p><h1 id=packagejson>package.json<a href=#packagejson class=hanchor arialabel=Anchor>&#8983;</a></h1><p>browserify uses the <code>package.json</code> in its module resolution algorithm, just like
node. If there is a <code>"main"</code> field, browserify will start resolving the package
at that point. If there is no <code>"main"</code> field, browserify will look for an
<code>"index.js"</code> file in the module root directory. Here are some more
sophisticated things you can do in the package.json:</p><h2 id=browser-field>browser field<a href=#browser-field class=hanchor arialabel=Anchor>&#8983;</a></h2><p>There is a special &ldquo;<a href=https://gist.github.com/4339901>browser</a>&rdquo; field you can
set in your package.json on a per-module basis to override file resolution for
browser-specific versions of files.</p><p>For example, if you want to have a browser-specific module entry point for your
<code>"main"</code> field you can just set the <code>"browser"</code> field to a string:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;browser&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#e6db74>&#34;./browser.js&#34;</span>
</span></span></code></pre></div><p>or you can have overrides on a per-file basis:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;browser&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;fs&#34;</span>: <span style=color:#e6db74>&#34;level-fs&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;./lib/ops.js&#34;</span>: <span style=color:#e6db74>&#34;./browser/opts.js&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note that the browser field only applies to files in the local module, and like
transforms, it doesn&rsquo;t apply into <code>node_modules</code> directories.</p><h2 id=browserifytransform>browserify.transform<a href=#browserifytransform class=hanchor arialabel=Anchor>&#8983;</a></h2><p>You can specify source transforms in the package.json in the
<code>browserify.transform</code> field. There is more information about how source
transforms work in package.json on the
<a href=https://github.com/substack/module-deps#transforms>module-deps readme</a>.</p><p>For example, if your module requires <a href=https://www.npmjs.com/package/brfs>brfs</a>, you
can add</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;browserify&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> { <span style=color:#f92672>&#34;transform&#34;</span>: [ <span style=color:#e6db74>&#34;brfs&#34;</span> ] }
</span></span></code></pre></div><p>to your package.json. Now when somebody <code>require()</code>s your module, brfs will
automatically be applied to the files in your module without explicit
intervention by the person using your module. Make sure to add transforms to
your package.json dependencies field.</p><h1 id=events>events<a href=#events class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=bonfile-function-file-id-parent->b.on(&lsquo;file&rsquo;, function (file, id, parent) {})<a href=#bonfile-function-file-id-parent- class=hanchor arialabel=Anchor>&#8983;</a></h2><h2 id=bpipelineonfile-function-file-id-parent->b.pipeline.on(&lsquo;file&rsquo;, function (file, id, parent) {})<a href=#bpipelineonfile-function-file-id-parent- class=hanchor arialabel=Anchor>&#8983;</a></h2><p>When a file is resolved for the bundle, the bundle emits a <code>'file'</code> event with
the full <code>file</code> path, the <code>id</code> string passed to <code>require()</code>, and the <code>parent</code>
object used by
<a href=https://github.com/defunctzombie/node-browser-resolve>browser-resolve</a>.</p><p>You could use the <code>file</code> event to implement a file watcher to regenerate bundles
when files change.</p><h2 id=bonpackage-function-pkg->b.on(&lsquo;package&rsquo;, function (pkg) {})<a href=#bonpackage-function-pkg- class=hanchor arialabel=Anchor>&#8983;</a></h2><h2 id=bpipelineonpackage-function-pkg->b.pipeline.on(&lsquo;package&rsquo;, function (pkg) {})<a href=#bpipelineonpackage-function-pkg- class=hanchor arialabel=Anchor>&#8983;</a></h2><p>When a package file is read, this event fires with the contents. The package
directory is available at <code>pkg.__dirname</code>.</p><h2 id=bonbundle-function-bundle->b.on(&lsquo;bundle&rsquo;, function (bundle) {})<a href=#bonbundle-function-bundle- class=hanchor arialabel=Anchor>&#8983;</a></h2><p>When <code>.bundle()</code> is called, this event fires with the <code>bundle</code> output stream.</p><h2 id=bonreset-function-->b.on(&lsquo;reset&rsquo;, function () {})<a href=#bonreset-function-- class=hanchor arialabel=Anchor>&#8983;</a></h2><p>When the <code>.reset()</code> method is called or implicitly called by another call to
<code>.bundle()</code>, this event fires.</p><h2 id=bontransform-function-tr-file->b.on(&rsquo;transform&rsquo;, function (tr, file) {})<a href=#bontransform-function-tr-file- class=hanchor arialabel=Anchor>&#8983;</a></h2><h2 id=bpipelineontransform-function-tr-file->b.pipeline.on(&rsquo;transform&rsquo;, function (tr, file) {})<a href=#bpipelineontransform-function-tr-file- class=hanchor arialabel=Anchor>&#8983;</a></h2><p>When a transform is applied to a file, the <code>'transform'</code> event fires on the
bundle stream with the transform stream <code>tr</code> and the <code>file</code> that the transform
is being applied to.</p><h1 id=plugins>plugins<a href=#plugins class=hanchor arialabel=Anchor>&#8983;</a></h1><p>For some more advanced use-cases, a transform is not sufficiently extensible.
Plugins are modules that take the bundle instance as their first parameter and
an option hash as their second.</p><p>Plugins can be used to do perform some fancy features that transforms can&rsquo;t do.
For example, <a href=https://www.npmjs.com/package/factor-bundle>factor-bundle</a> is a
plugin that can factor out common dependencies from multiple entry-points into a
common bundle. Use plugins with <code>-p</code> and pass options to plugins with
<a href=https://www.npmjs.com/package/subarg>subarg</a> syntax:</p><pre tabindex=0><code>browserify x.js y.js -p [ factor-bundle -o bundle/x.js -o bundle/y.js ] \
  &gt; bundle/common.js
</code></pre><p>For a list of plugins, consult the
<a href=https://www.npmjs.com/browse/keyword/browserify-plugin>browserify-plugin tag</a>
on npm.</p><h1 id=list-of-source-transforms>list of source transforms<a href=#list-of-source-transforms class=hanchor arialabel=Anchor>&#8983;</a></h1><p>There is a <a href=https://github.com/substack/node-browserify/wiki/list-of-transforms>wiki page that lists the known browserify
transforms</a>.</p><p>If you write a transform, make sure to add your transform to that wiki page and
add a package.json keyword of <code>browserify-transform</code> so that
<a href=https://www.npmjs.com/browse/keyword/browserify-transform>people can browse for all the browserify
transforms</a> on npmjs.org.</p><h1 id=third-party-tools>third-party tools<a href=#third-party-tools class=hanchor arialabel=Anchor>&#8983;</a></h1><p>There is a <a href=https://github.com/substack/node-browserify/wiki/browserify-tools>wiki page that lists the known browserify
tools</a>.</p><p>If you write a tool, make sure to add it to that wiki page and
add a package.json keyword of <code>browserify-tool</code> so that
<a href=https://www.npmjs.com/browse/keyword/browserify-tool>people can browse for all the browserify
tools</a> on npmjs.org.</p><h1 id=changelog>changelog<a href=#changelog class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Releases are documented in
<a href=changelog.markdown>changelog.markdown</a> and on the
<a href=https://twitter.com/browserify>browserify twitter feed</a>.</p><h1 id=license>license<a href=#license class=hanchor arialabel=Anchor>&#8983;</a></h1><p>MIT</p><p><img src=http://substack.net/images/browserify/browserify.png alt=browserify!></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/academy/bigdata/><span class=button__icon>←</span>
<span class=button__text>bigdata.md</span></a></span>
<span class="button next"><a href=/posts/misc/clojure/><span class=button__text>clojure.md</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>@linuxing3</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
<script src=/assets/languageSelector.js></script></div></body></html>