<!doctype html><html lang=en><head><title>lapis_console.md :: Vim Emacser Personal Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="title: Lapis Console Lapis Console Lapis Console is a separate project that adds an interactive console to your web application. Because Lapis runs inside of the Nginx loop, it&amp;rsquo;s not trivial to make a standard terminal based console that behaves the same way as the web application. So a console that runs inside of your browser was created, letting you reliably execute code in the same way as your web application when debugging."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/misc/lapis_console/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content="https://twitter.com/linuxing3"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="lapis_console.md"><meta property="og:description" content="title: Lapis Console Lapis Console Lapis Console is a separate project that adds an interactive console to your web application. Because Lapis runs inside of the Nginx loop, it&amp;rsquo;s not trivial to make a standard terminal based console that behaves the same way as the web application. So a console that runs inside of your browser was created, letting you reliably execute code in the same way as your web application when debugging."><meta property="og:url" content="/posts/misc/lapis_console/"><meta property="og:site_name" content="Vim Emacser Personal Blog"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2018-02-16 14:05:34 -0400 -0400"></head><body class=green><div class="container full"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Terminal</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/journal>Journal</a></li><li><a href=/showcase>Showcase</a></li><div class=spacer></div><ul class=language-selector><ul class=language-selector-current><li>English ▾</li></ul><ul class="language-selector__more hidden"><li><a href=/>English</a></li><li><a href=/zh/>中文</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/journal>Journal</a></li><li><a href=/showcase>Showcase</a></li><hr><li><a href=/>English</a></li><li><a href=/zh/>中文</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/misc/lapis_console/>lapis_console.md</a></h1><div class=post-meta><span class=post-date>2018-02-16</span></div><div class=post-content><div><h2 id=title-lapis-console>title: Lapis Console<a href=#title-lapis-console class=hanchor arialabel=Anchor>&#8983;</a></h2><h1 id=lapis-console>Lapis Console<a href=#lapis-console class=hanchor arialabel=Anchor>&#8983;</a></h1><p><a href=https://github.com/leafo/lapis-console>Lapis Console</a> is a separate project that adds an interactive console to
your web application. Because Lapis runs inside of the Nginx loop, it&rsquo;s not
trivial to make a standard terminal based console that behaves the same way as
the web application. So a console that runs inside of your browser was created,
letting you reliably execute code in the same way as your web application when
debugging.</p><p><img src=http://leafo.net/dump/lapis_console.png alt="Lapis Console Screenshot" title="Screenshot of the Lapis Console exploring an object."></p><p>Install through LuaRocks:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ luarocks install --server<span style=color:#f92672>=</span>http://rocks.moonscript.org lapis-console
</span></span></code></pre></div><h2 id=creating-a-console>Creating A Console<a href=#creating-a-console class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=consolemakeopts><code>console.make([opts])</code><a href=#consolemakeopts class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Lapis console provides an action that you can insert into your application to a
route of your choosing:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#66d9ef>local</span> lapis <span style=color:#f92672>=</span> require(<span style=color:#e6db74>&#34;lapis&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>local</span> console <span style=color:#f92672>=</span> require(<span style=color:#e6db74>&#34;lapis.console&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>local</span> app <span style=color:#f92672>=</span> lapis.Application()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app:match(<span style=color:#e6db74>&#34;/console&#34;</span>, console.make())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> app
</span></span></code></pre></div><pre tabindex=0><code class=language-moon data-lang=moon>lapis = require &#34;lapis&#34;
console = require &#34;lapis.console&#34;

class extends lapis.Application
  &#34;/console&#34;: console.make!
</code></pre><p>Now just head to to the <code>/console</code> location in your browser to use it. By
default the action that is created will only run in the <code>"development"</code>
environment.</p><p>You can set the <code>env</code> option in the first argument to <code>"all"</code> to enable in
every environment, or you can name an environment.</p><blockquote><p>Be careful about allowing access to the console, a malicious individual could
destroy your application and compromise your system if given access.</p></blockquote><h2 id=tips>Tips<a href=#tips class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The console lets your write and execute a MoonScript program. Multiple lines
are supported.</p><p>The <code>print</code> function has been replaced in the console to print to the debug
output. You can print any type of object and the console will pretty print it.
Tables can be opened up and other types are color coded.</p><p>Any queries that execute during the script are logged to a special portion on
the bottom of the output.</p><p><code>@</code> is equal to the value of the request that is initiating the console. You
can use this if you are testing a method that needs a request object.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/nodejs/karma/><span class=button__icon>←</span>
<span class=button__text>karma.md</span></a></span>
<span class="button next"><a href=/posts/misc/lapis/><span class=button__text>lapis.md</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>@linuxing3</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
<script src=/assets/languageSelector.js></script></div></body></html>