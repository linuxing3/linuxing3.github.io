<!doctype html><html lang=en><head><title>Emacs字体设置方法总结 - CodeAntenna :: Vim Emacser Personal Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="[2021-11-12 周五 11:13] 由于目前的状况是两种字体系统并存，我们安装字体时就必须同时照顾到两者。 有时候在网上我们会看到一些字体安装经验介绍，比如：“安装字体太简单了， 把字体丢到 ~/.fonts 下面，执行一下 fc-cache 命令，你就可以在 firefox 中 使用这个字体了。”实际上，这只是为 xft 字体系统安装字体的方法，按这种方 法安装的字体，采用核心字体系统的程序无法使用，也就是说 emacs 无法使用这 样安装的字体。
第一步，拷贝字体。选择一个目录，把想用的字体拷贝到这个目录下。比如：
cp simsun.ttf /path/to/my/truetype/font/simsun.ttf 第二步，生成 fonts.scale 与 fonts.dir 在你的字体目录下用 mkfontscale 命令生成 fonts.scale 文件，用 mkfontdir 命令生成 fonts.dir 文件，注意 命令的顺序不能颠倒，否则生成 的 fonts.dir 是空文件。其实这两个文件的内 容是一样的，因此也可以直接 cp fonts.scale fonts.dir
不知道是什么原因 mkfontscale/mkfontdir 命令生成的 fonts.scale 文件中 缺少对 gbk 字体的支持，因此需要手工编辑 fonts.scale，添加一行：
simsun.ttf -misc-simsun-medium-r-normal--0-0-0-0-p-0-gbk-0 如果你用的是不同的字体，这一行的内容可能不太一样，但需要注意的是必须要 加上一个以 gbk-0 结尾的行。同时，文件第一行的那个数字要加1。 fonts.dir文件也要进行相应的修改，使这两个文件保持一致。如果不进行这 一步，就无法使用 gbk 字体。
第三步，修改 /etc/X11/xorg.conf (如果你在用 XFree86, 那就修改 XF86Config-4): 找到 Section &amp;ldquo;Module&amp;rdquo;, 加载 freetype 模块： Section &amp;ldquo;Module&amp;rdquo; &amp;hellip;&amp;hellip; Load &amp;ldquo;freetype&amp;rdquo; &amp;hellip;&amp;hellip; EndSection 找到 Section &amp;ldquo;Files&amp;rdquo;, 添加你的字体路径： Section &amp;ldquo;Files&amp;rdquo; &amp;hellip;&amp;hellip; FontPath &amp;ldquo;/path/to/my/truetype/font&amp;rdquo; &amp;hellip;&amp;hellip; EndSection 最后重新启动 X，这时候用 xlsfonts 命令应该能看到你安装的字体。"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/emacs/emacs%E5%AD%97%E4%BD%93%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93_codeantenna/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content="https://twitter.com/linuxing3"><meta name=twitter:creator content="[Xing Wenju]"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Emacs字体设置方法总结 - CodeAntenna"><meta property="og:description" content="[2021-11-12 周五 11:13] 由于目前的状况是两种字体系统并存，我们安装字体时就必须同时照顾到两者。 有时候在网上我们会看到一些字体安装经验介绍，比如：“安装字体太简单了， 把字体丢到 ~/.fonts 下面，执行一下 fc-cache 命令，你就可以在 firefox 中 使用这个字体了。”实际上，这只是为 xft 字体系统安装字体的方法，按这种方 法安装的字体，采用核心字体系统的程序无法使用，也就是说 emacs 无法使用这 样安装的字体。
第一步，拷贝字体。选择一个目录，把想用的字体拷贝到这个目录下。比如：
cp simsun.ttf /path/to/my/truetype/font/simsun.ttf 第二步，生成 fonts.scale 与 fonts.dir 在你的字体目录下用 mkfontscale 命令生成 fonts.scale 文件，用 mkfontdir 命令生成 fonts.dir 文件，注意 命令的顺序不能颠倒，否则生成 的 fonts.dir 是空文件。其实这两个文件的内 容是一样的，因此也可以直接 cp fonts.scale fonts.dir
不知道是什么原因 mkfontscale/mkfontdir 命令生成的 fonts.scale 文件中 缺少对 gbk 字体的支持，因此需要手工编辑 fonts.scale，添加一行：
simsun.ttf -misc-simsun-medium-r-normal--0-0-0-0-p-0-gbk-0 如果你用的是不同的字体，这一行的内容可能不太一样，但需要注意的是必须要 加上一个以 gbk-0 结尾的行。同时，文件第一行的那个数字要加1。 fonts.dir文件也要进行相应的修改，使这两个文件保持一致。如果不进行这 一步，就无法使用 gbk 字体。
第三步，修改 /etc/X11/xorg.conf (如果你在用 XFree86, 那就修改 XF86Config-4): 找到 Section &amp;ldquo;Module&amp;rdquo;, 加载 freetype 模块： Section &amp;ldquo;Module&amp;rdquo; &amp;hellip;&amp;hellip; Load &amp;ldquo;freetype&amp;rdquo; &amp;hellip;&amp;hellip; EndSection 找到 Section &amp;ldquo;Files&amp;rdquo;, 添加你的字体路径： Section &amp;ldquo;Files&amp;rdquo; &amp;hellip;&amp;hellip; FontPath &amp;ldquo;/path/to/my/truetype/font&amp;rdquo; &amp;hellip;&amp;hellip; EndSection 最后重新启动 X，这时候用 xlsfonts 命令应该能看到你安装的字体。"><meta property="og:url" content="/posts/emacs/emacs%E5%AD%97%E4%BD%93%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93_codeantenna/"><meta property="og:site_name" content="Vim Emacser Personal Blog"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-11-12 00:00:00 -0400 -0400"></head><body class=green><div class="container full"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Terminal</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/journal>Journal</a></li><li><a href=/showcase>Showcase</a></li><div class=spacer></div><ul class=language-selector><ul class=language-selector-current><li>English ▾</li></ul><ul class="language-selector__more hidden"><li><a href=/>English</a></li><li><a href=/zh/>中文</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/journal>Journal</a></li><li><a href=/showcase>Showcase</a></li><hr><li><a href=/>English</a></li><li><a href=/zh/>中文</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/emacs/emacs%E5%AD%97%E4%BD%93%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93_codeantenna/>Emacs字体设置方法总结 - CodeAntenna</a></h1><div class=post-meta><span class=post-date>2021-11-12</span>
<span class=post-author>:: [Xing Wenju]</span></div><div class=post-content><div><h2>[2021-11-12 周五 11:13]</h2><p>由于目前的状况是两种字体系统并存，我们安装字体时就必须同时照顾到两者。 有时候在网上我们会看到一些字体安装经验介绍，比如：“安装字体太简单了， 把字体丢到 ~/.fonts 下面，执行一下 fc-cache 命令，你就可以在 firefox 中 使用这个字体了。”实际上，这只是为 xft 字体系统安装字体的方法，按这种方 法安装的字体，采用核心字体系统的程序无法使用，也就是说 emacs 无法使用这 样安装的字体。</p><p>第一步，拷贝字体。选择一个目录，把想用的字体拷贝到这个目录下。比如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cp simsun.ttf /path/to/my/truetype/font/simsun.ttf
</span></span></code></pre></div><p>第二步，生成 fonts.scale 与 fonts.dir 在你的字体目录下用 mkfontscale
命令生成 fonts.scale 文件，用 mkfontdir 命令生成 fonts.dir 文件，注意
命令的顺序不能颠倒，否则生成 的 fonts.dir 是空文件。其实这两个文件的内
容是一样的，因此也可以直接 cp fonts.scale fonts.dir</p><p>不知道是什么原因 mkfontscale/mkfontdir 命令生成的 fonts.scale 文件中 缺少对 gbk 字体的支持，因此需要手工编辑 fonts.scale，添加一行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>simsun.ttf -misc-simsun-medium-r-normal--0-0-0-0-p-0-gbk-0
</span></span></code></pre></div><p>如果你用的是不同的字体，这一行的内容可能不太一样，但需要注意的是必须要 加上一个以 gbk-0 结尾的行。同时，文件第一行的那个数字要加1。 fonts.dir文件也要进行相应的修改，使这两个文件保持一致。如果不进行这 一步，就无法使用 gbk 字体。</p><p>第三步，修改 /etc/X11/xorg.conf (如果你在用 XFree86, 那就修改 XF86Config-4): 找到 Section &ldquo;Module&rdquo;, 加载 freetype 模块： Section &ldquo;Module&rdquo; &mldr;&mldr; Load &ldquo;freetype&rdquo; &mldr;&mldr; EndSection 找到 Section &ldquo;Files&rdquo;, 添加你的字体路径： Section &ldquo;Files&rdquo; &mldr;&mldr; FontPath &ldquo;/path/to/my/truetype/font&rdquo; &mldr;&mldr; EndSection 最后重新启动 X，这时候用 xlsfonts 命令应该能看到你安装的字体。</p><blockquote><p>注意，只 有 xlsfonts 列出的字体，emacs 才能使用。</p></blockquote><p>由于 emacs 是个支持多语言的程序，它支持很多种字符集，而一种字体一般只覆 盖一个或几个字符集，因此只用一种字体是无法显示 emacs 支持的所有文字的。 因此在emacs中需要设置 fontset，也就是多种字体的集合，或者叫做字体集。 如果我们不指定 fontset, 那么 emacs 会使用默认的 fontset-default 来显示 字体。如果你觉得这种字体不好看，就需要自己定义 fontset。</p><p>定义 fontset 有 两种方式</p><p>一种是在 ~/.emacs 中使用 create-fontset-from-fontset-spec 函 数，</p><p>一种是在 ~/.Xdefaults 中定义资源。我们分别介绍这两种方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>-adobe-courier-medium-r-normal--0-0-0-0-p-0-iso8859-1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-adobe-courier-medium-r-normal--14-*-*-*-p-*-fontset-courier
</span></span></code></pre></div><p>选定了字体就可以用 create-fontset-from-fontset-spec 函数定义 fontset 了，这个函数很简单，它的参数是个字符串：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>
</span></span><span style=display:flex><span>(create-fontset-from-fontset-spec (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;-*-courier-medium-r-normal-*-14-*-*-*-*-*-fontset-courier,&#34;</span> <span style=color:#e6db74>&#34;chinese-gb2312:-*-simsun-medium-r-*-*-14-*-*-*-c-*-gb2312*-*,&#34;</span> <span style=color:#e6db74>&#34;mule-unicode-0100-24ff:-*-simsun-medium-r-*-*-14-*-*-*-c-*-iso10646*-*,&#34;</span> <span style=color:#e6db74>&#34;korean-ksc5601:-*-*-medium-r-*-*-14-*-*-*-*-*-ksc5601*-*,&#34;</span> <span style=color:#e6db74>&#34;chinese-cns11643-5:-*-simsun-medium-r-*-*-14-*-*-*-c-*-gbk*-*,&#34;</span> <span style=color:#e6db74>&#34;chinese-cns11643-6:-*-simsun-medium-r-*-*-14-*-*-*-c-*-gbk*-*,&#34;</span> <span style=color:#e6db74>&#34;chinese-cns11643-7:-*-simsun-medium-r-*-*-14-*-*-*-c-*-gbk*-*,&#34;</span> <span style=color:#e6db74>&#34;sjis:-*-medium-r-normal--14-*-jisx0208*-*&#34;</span>))
</span></span><span style=display:flex><span>(set-default-font <span style=color:#e6db74>&#34;fontset-courier&#34;</span>)
</span></span></code></pre></div><p>另外，为了让 emacs 创建新的 frame 时 (C-x 5 系列命令) 采用我们指定的 fontset，还要进行下面的设置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq default-frame-alist (<span style=color:#a6e22e>append</span> <span style=color:#f92672>&#39;</span>((font <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;fontset-courier&#34;</span>)) default-frame-alist))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>
</span></span><span style=display:flex><span>Emacs.Fontset-0:-*-courier-medium-r-normal-*-14-*-*-*-*-*-fontset-courier,/ chinese-gb2312:-*-simsun-medium-r-*-*-14-*-*-*-c-*-*-*,/ mule-unicode-0100-24ff:-*-simsun-medium-r-*-*-14-*-*-*-c-*-iso10646*-*,/ korean-ksc5601:-*-*-medium-r-*-*-14-*-*-*-*-*-ksc5601*-*,/ chinese-cns11643-5:-*-simsun-medium-r-*-*-14-*-*-*-c-*-gbk*-*,/ chinese-cns11643-6:-*-simsun-medium-r-*-*-14-*-*-*-c-*-gbk*-*,/ chinese-cns11643-7:-*-simsun-medium-r-*-*-14-*-*-*-c-*-gbk*-*,/ sjis:-*-medium-r-normal--14-*-jisx0208*-*
</span></span></code></pre></div></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2021-11-12/><span class=button__icon>←</span>
<span class=button__text>Continue journey to Emacs Desktop</span></a></span>
<span class="button next"><a href=/posts/emacs/creating_timestamps_the_org_manual/><span class=button__text>Creating Timestamps (The Org Manual)</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>@linuxing3</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
<script src=/assets/languageSelector.js></script></div></body></html>